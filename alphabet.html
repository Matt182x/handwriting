<!DOCTYPE html>
<html>
<head>
    <title>Alphabet Capture</title>
    <style>
        canvas { border: 1px solid #000; touch-action: none; }
        #letter { font-size: 3em; margin-bottom: 10px; }
        button { margin: 5px; font-size: 1em; padding: 5px 10px; }
    </style>
</head>
<body>
    <h1>Write the alphabet!</h1>
    <div id="letter">a</div>
    <canvas id="canvas" width="400" height="200"></canvas><br>
    <button id="playSoundBtn">ðŸ”Š Play Sound</button>
    <button id="nextBtn">Next Letter</button>

    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.0/dist/signature_pad.umd.min.js"></script>
    <script>
        const letters = 'abcdefghijklmnopqrstuvwxyz';
        let index = 0;

        const canvas = document.getElementById('canvas');
        const letterDiv = document.getElementById('letter');
        const signaturePad = new SignaturePad(canvas, { backgroundColor: 'rgba(255,255,255,1)' });

        // Play the letter sound
        document.getElementById('playSoundBtn').addEventListener('click', () => {
            const utterance = new SpeechSynthesisUtterance(letters[index]);
            window.speechSynthesis.speak(utterance);
        });

        // Go to next letter and save
        document.getElementById('nextBtn').addEventListener('click', () => {
            if (signaturePad.isEmpty()) {
                alert("Please write the letter first.");
                return;
            }

            // Save image to backend
            const dataURL = signaturePad.toDataURL('image/png');
            fetch('/save_letter', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ letter: letters[index], image: dataURL })
            }).then(res => res.text()).then(console.log);

            // Clear canvas and go to next letter
            signaturePad.clear();
            index++;
            if (index < letters.length) {
                letterDiv.innerText = letters[index];
            } else {
                letterDiv.innerText = "Done!";
                alert("All letters captured!");
            }
        });
    </script>
</body>
</html>
